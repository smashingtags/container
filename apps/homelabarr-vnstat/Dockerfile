## This file is automatically generated (based on release.json)
##
## Do not changes any lines here
##
####################################
# All rights reserved.              #
# started from Zero                 #
# Docker owned dockserver           #
# Docker Maintainer dockserver      #
#####################################
#####################################
# THIS DOCKER IS UNDER LICENSE      #
# NO CUSTOMIZING IS ALLOWED         #
# NO REBRANDING IS ALLOWED          #
# NO CODE MIRRORING IS ALLOWED      #
#####################################
# shellcheck disable=SC2086
# shellcheck disable=SC2046
FROM php:8-apache

LABEL org.opencontainers.image.source="https://github.com/smashingtags/homelabarr-containers"

ARG TARGETPLATFORM
ARG BUILDPLATFORM

# Architecture-aware package installation for ARM64 compatibility
RUN \
  echo "**** Platform: $TARGETPLATFORM ****" && \
  echo "**** install build packages ****" && \
  apt-get update -yqq && \
  apt-get install -yqq \
    git \
    unzip \
    apt-utils \
    ca-certificates \
    curl && \
  echo "**** architecture-specific setup ****" && \
  if [ "$TARGETPLATFORM" = "linux/arm64" ]; then \
    echo "Setting up ARM64 specific configurations"; \
    apt-get install -yqq build-essential; \
  else \
    echo "Setting up AMD64 configurations"; \
  fi && \
  echo "**** cleanup ****" && \
  apt-get autoremove -yqq && \
  apt-get autoclean -yqq && \
  rm -rf /var/lib/apt/lists/*

RUN curl -sS https://getcomposer.org/installer | php && mv composer.phar /usr/local/bin/composer

COPY ./apps/homelabarr-vnstat/app/ /var/www/html/

RUN composer install --quiet && mkdir -p /var/lib/vnstat

##EOF
